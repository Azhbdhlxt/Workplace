C51 COMPILER V9.00   MAIN                                                                  02/23/2018 16:30:37 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*********************************************************************************
   2          * 【作    者】：        清翔电子:向量
   3          * 【版    本】：        V1.0
   4          * 【网    站】：        http://www.qxmcu.com/ 
   5          * 【淘宝店铺】：        http://qxmcu.taobao.com/
   6          * 【实验平台】：        清翔 QX-MCS51 单片机开发板
   7          * 【外部晶振】：        11.0592mhz      
   8          * 【主控芯片】：        STC89C52
   9          * 【编译环境】：        Keil μVisio4   
  10          * 【程序功能】：        8*8点阵循环显示 “电”“子”                                                                        
  11          * 【使用说明】：        正确安装上点阵模块
  12          **********************************************************************************/
  13          #include <reg52.h>
  14          #include <intrins.h> //循环右移头文件
  15          sbit DIO = P3^4;  //串行数据口
  16          sbit S_CLK = P3^5;//移位寄存器时钟
  17          sbit R_CLK = P3^6;//输出锁存器时钟
  18          /*点阵字形码*/
  19          unsigned char code tabel[2][8]={
  20          
  21          0xE0,0xEE,0x01,0x6D,0x01,0x6D,0x01,0xEF,//电
  22          0xE7,0xF7,0xF7,0xF7,0x80,0xF7,0xFB,0xC3//子
  23          };
  24          /*595发送一字节*/
  25          void Send_Byte(unsigned char dat)
  26          {
  27   1              unsigned char i; //循环次数变量
  28   1              S_CLK = 0;//拉低移位寄存器时钟
  29   1              R_CLK = 0;//拉低输出锁存器时钟
  30   1              for(i=0; i<8; i++) //循环8次
  31   1              {
  32   2                      if(dat & 0x01)//发送1
  33   2                              DIO = 1;
  34   2                              else      //发送0
  35   2                              DIO = 0;
  36   2                      dat >>= 1;//数据右移
  37   2                      S_CLK = 1;//拉高移位寄存器时钟，数据移位
  38   2                      S_CLK = 0;//拉低移位寄存器时钟
  39   2              }       
  40   1      }
  41          void main()
  42          {
  43   1              unsigned char j, k, ROW;//j发送8列和8行字形码，k字符数量，ROW行值
  44   1              unsigned int z; //动态扫描延时变量
  45   1              while(1)
  46   1              {
  47   2                      for(k=0; k<2; k++)//k 需要显示的字符数量
  48   2                      {
  49   3                              for(z=0; z<1000; z++)//z刷新次数
  50   3                              {
  51   4                                      ROW = 0x80;//行选初值
  52   4                                      for(j=0; j<8; j++) //循环8次发送行和列值
  53   4                                      {
  54   5                                              Send_Byte(tabel[k][j]);//发送列选值
  55   5                                              Send_Byte(ROW); //发送行选值
C51 COMPILER V9.00   MAIN                                                                  02/23/2018 16:30:37 PAGE 2   

  56   5                                              R_CLK = 1; //拉高输出锁存器，把移位寄存器中数据输出
  57   5                                              R_CLK = 0; //拉低输出锁存器
  58   5                                              ROW = _cror_(ROW, 1);//右移，选择下一行 
  59   5                                      }
  60   4                              }
  61   3                      }
  62   2              }
  63   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    110    ----
   CONSTANT SIZE    =     16    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
