C51 COMPILER V9.00   MAIN                                                                  08/17/2017 19:34:09 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*
   2          ****************结构体指针变量定义与引用************************
   3          打开串口后比特率设置为9600
   4          接收模式为文本模式
   5          */
   6          #include <reg52.h>
   7          #include <stdio.h>
   8          
   9          struct date{ //定义结构体类型
  10                  unsigned int year;
  11                  unsigned char month, day;       
  12          };
  13          /*毫秒级延时函数*/
  14          void Delay_Ms(unsigned int z)
  15          {
  16   1              unsigned int x,y;
  17   1              for(x = z; x > 0; x--)
  18   1                      for(y = 114; y > 0 ; y--);
  19   1      }       
  20          /*串口初始化，比特率9600*/
  21          void UART_Init()
  22          {
  23   1              TMOD |= 0x20;   //T1工作模式2  8位自动重装
  24   1              TH1 = 0xfd;
  25   1              TL1 = 0xfd;     //比特率9600
  26   1              TR1 = 1;                //启动T1定时器
  27   1              SM0 = 0;
  28   1              SM1 = 1;                //串口工作方式1 10位异步
  29   1      }
  30          
  31          void main()
  32          {
  33   1              struct date d1, d2;//定义结构体变量
  34   1              struct date *pd1;//定义结构体指针变量
  35   1              UART_Init(); //串口初始化
  36   1              TI = 1;//使用printf()puts()前都应软件置位TI = 1；
  37   1              pd1 = &d1;//结构体指针变量赋值,指向结构体变量d1
  38   1              pd1->year = 2017;//通过结构体指针来引用结构体元素
  39   1              pd1->month = 5;
  40   1              pd1->day = 13;
  41   1      
  42   1              d2.year = 2018;//通过结构体指针来引用结构体元素
  43   1              d2.month = 8;
  44   1              d2.day = 8;
  45   1              while(1)
  46   1              {
  47   2                      pd1 = &d1;//指向结构体变量d1
  48   2                      /*在Keil C51中用printf输出一个单字节数据时要使用%bd,输出十六位数据要用%hd，输出三十二位数据%ld*/
  49   2                      printf(" year: %hd \n month: %bd \n day: %bd \n", pd1->year, pd1->month, pd1->day);
  50   2                      pd1++;//指向下一个结构体变量
  51   2                      printf(" year: %hd  month: %bd  day: %bd \n", pd1->year, pd1->month, pd1->day);
  52   2                      Delay_Ms(5000);//5秒发送一次
  53   2              }       
  54   1      }
  55          /*************************************
C51 COMPILER V9.00   MAIN                                                                  08/17/2017 19:34:09 PAGE 2   

  56          备注：
  57          使用printf()puts()前都应软件置位TI = 1；
  58          printf()puts()  使用putchar函数发送字节
  59          
  60          void putchar(uchar sbyte )
  61          {
  62              while(！TI);   //等待发送完
  63          
  64              SBUF=sbyte;
  65          
  66          }
  67          
  68          所第调用putchar前没TI=1 永远等待
  69          *************************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    214    ----
   CONSTANT SIZE    =     72    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
