C51 COMPILER V9.00   MAIN                                                                  08/10/2019 12:17:16 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*
   2          ****************结构体变量定义与引用************************
   3          打开串口后比特率设置为9600
   4          接收模式为文本模式
   5          */
   6          #include <reg52.h>
   7          #include <stdio.h>
   8          
   9          struct date{ //定义结构体类型
  10                  unsigned int year;
  11                  unsigned char month, day;       
  12          };
  13          /*毫秒级延时函数*/
  14          void Delay_Ms(unsigned int z)
  15          {
  16   1              unsigned int x,y;
  17   1              for(x = z; x > 0; x--)
  18   1                      for(y = 114; y > 0 ; y--);
  19   1      }       
  20          /*串口初始化，比特率9600*/
  21          void UART_Init()
  22          {
  23   1              TMOD |= 0x20;   //T1工作模式2  8位自动重装
  24   1              TH1 = 0xfd;
  25   1              TL1 = 0xfd;     //比特率9600
  26   1              TR1 = 1;                //启动T1定时器
  27   1              SM0 = 0;
  28   1              SM1 = 1;                //串口工作方式1 10位异步
  29   1      }
  30          
  31          void main()
  32          {
  33   1              struct date d1;//定义结构体变量
  34   1              UART_Init(); //串口初始化
  35   1              TI = 1;         //使用printf()puts()前都应软件置位TI = 1；
  36   1              d1.year = 2017;//引用结构体元素
  37   1              d1.month =      5;
  38   1              d1.day = 13;
  39   1              while(1)
  40   1              {
  41   2                      /*在Keil C51中用printf输出一个单字节数据时要使用%bd,输出十六位数据要用%hd，输出三十二位数据%ld*/
  42   2                      printf(" year: %hd \n month: %bd \n day: %bd \n", d1.year, d1.month, d1.day);
  43   2                      Delay_Ms(5000);//5秒发送一次
  44   2              }       
  45   1      }
  46          /*************************************
  47          备注：
  48          使用printf()puts()前都应软件置位TI = 1；
  49          printf()puts()  使用putchar函数发送字节
  50          
  51          void putchar(uchar sbyte )
  52          {
  53              while(！TI);   //等待发送完
  54          
  55              SBUF=sbyte;
C51 COMPILER V9.00   MAIN                                                                  08/10/2019 12:17:16 PAGE 2   

  56          
  57          }
  58          
  59          所第调用putchar前没TI=1 永远等待
  60          *************************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     93    ----
   CONSTANT SIZE    =     37    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
